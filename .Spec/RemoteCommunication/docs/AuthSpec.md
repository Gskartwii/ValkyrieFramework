# ATTN: This specification was not implemented!!

The gameserver â†” Global server auth
=====================================
The method that's going to be used for authenticating the game servers is going 
to be similar to the one I used for my warclan tech stuff. If you have any ideas
on how to improve this, would surely like to hear.

The terminology used
--------------------
- *Client*: A game that runs on the engine
- *Server*: The global server (gskw.noip.me)
- *CoKey*: The permanent, private connection key that the client sends to the
  server at the beginning of the process to authenticate
- *TKey*: A temporary key generated by the server when a request is sent
- *GID*: A game ID, the suffix of the MySQL tables that store the information for
  the client in question
- *A trusted place*: A place that is allowed to use the services

The process
-----------

1.  `[Client]` Send a HTTP request to the global server with the TKey and GID.
2.  `[Server]` Generate a new TKey
3.  `[Server]` Create a ModuleScript with the TKey saved in it and upload it to
    the a model on Roblox
4.  `[Server]` Save the generated TKey in the database, waiting for it to be
    verified
5.  `[Server]` Sent the versionID of the recently uploaded model back to the
    client
6.  `[Client]` Load the ModuleScript and require it.
7.  `[MScrpt]` Send the TKey, GID and the current place ID to the server.
8.  `[Server]` Check if all of those match. If they do, make the TKey active
9.  `[MScrpt]` Set workspace.TKey (a NumberValue) to the new TKey
10. `[MScrpt]` Set the `game.OnClose` callback to expire the TKey (will be 
    explained later)
11. `[Client]` Check if the new TKey is valid: send a request to the server to 
    check that
12. `[Server]` Reply with the result
13. `[Client]` Start using the services

Expiration
----------
When the `game.OnClose` callback is called, the following process is ran.

1. `[MScrpt]` Send a request to the server with the GID, TKey and place id.
2. `[Server]` If all of those match, remove the TKey from the database.

Service usage
-------------
To use the services, a GID, arguments and a TKey have to be provided. An example
request is:

    http://gskw.noip.me:5678/interface/new_messages.lua?gid=123_island_wars&tkey=
    9287459&args={'player':261}